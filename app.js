const profile = {
  name: 'Paul Millington',
  summary:
    'Strategic and results-driven Global Operations Director with expertise in AI-led operations, automation, vendor optimisation and scalable delivery models.',
  workHistory: [
    {
      role: 'Global Customer Operations Director',
      company: 'MindGym',
      dates: 'Oct 2022 – Present',
      location: 'Gateshead',
      scale: ['£5m budget', '300+ FTE', '30+ countries'],
      scope: 'Responsible for building and leading MindGym\'s global operations capability across Client & Coach Operations, Shared Services, Vendor Management, Business Systems Architecture, IT Service Management, and Change Implementation. Accountable for operational processes, delivery governance, global scheduling, capacity planning, and integration of platforms such as Salesforce, NetSuite, Administrate, and Coaching.com. Led 300+ FTE globally and managed a multi-million-pound operational budget, partnering with the CEO and CFO to shape the enterprise operating model, technology roadmap, and service standards.',
      highlights: [
        'Built and scaled global operations to support FTSE100 and Fortune 500 clients across 30+ countries.',
        'Led global AI, automation and process redesign programmes, rolling out AI-assisted scheduling and forecasting tools.',
        'Cut service issues by 40% via a new operations centre, service recovery controls and predictive analytics.',
        'Delivered 25% cost savings and £1m vendor savings through model redesign and supplier optimisation.',
        'Eliminated 60% of manual processes with Salesforce, NetSuite and Administrate automation; embedded data-driven decisions via JIRA, Clockify and Power BI.',
      ],
      cta: {
        label: 'See my work in action',
        url: 'assets/our-platform-for-growth.mp4',
      },
    },
    {
      role: 'European Director, Operational Excellence',
      company: 'Firstsource',
      dates: 'Apr 2021 – Oct 2022',
      location: 'United Kingdom',
      scale: ['1,500+ hires onboarded', 'Multi-client coverage'],
      scope: 'Accountable for operational excellence, customer experience, and compliance programmes across regulated UK organisations. Responsible for CX framework design, onboarding experience development, knowledge management, workflow governance, and embedding operational controls across multiple client brands. Supported operational leaders in improving service standards, onboarding processes, digital learning adoption, and compliance alignment.',
      highlights: [
        'Improved NPS by +10 points for a major bank while cutting FCA complaints by 25%.',
        'Reduced handling time by 15% through workflow optimisation and knowledge management uplift.',
        'Lowered early-life attrition by 20% through redesigned onboarding journeys.',
        'Implemented standardised QA frameworks across multiple regulated clients.',
        'Launched a digital learning platform for a Tier 1 global bank.',
      ],
    },
    {
      role: 'Global Head of Customer Care',
      company: 'FIS Worldpay',
      dates: 'Jan 2019 – Jan 2021',
      location: 'Gateshead',
      scale: ['650 FTE', '4 global delivery centres'],
      scope: 'Led global customer care operations serving SME and enterprise merchants across the UK, Europe, India, the Philippines, and Latin America. Accountable for service delivery, contact centre strategy, regulatory process ownership, partner management, operational governance, and customer support policy design. Oversaw in-house and BPO teams, workforce planning, service standards, and global operational controls.',
      highlights: [
        'Led a 650-FTE global customer care organisation across the UK, Philippines, Colombia and India.',
        'Cut operating costs by 30% with chatbot, video support and co-browsing self-service.',
        'Delivered £1m+ savings through vendor consolidation and onboarding a new strategic BPO.',
        'Improved First Contact Resolution by 10% with redesigned FCA-regulated complaint handling.',
        'Introduced global delivery standards to improve consistency across regions.',
      ],
    },
    {
      role: 'Senior Vice President, UK Operations',
      company: 'Worldpay',
      dates: 'Jan 2016 – Jan 2019',
      location: 'Gateshead',
      scale: ['1,000-seat operation', 'Chargebacks & onboarding'],
      scope: 'Reported to the UK Managing Director with accountability for Customer Service, Retention, Chargeback Operations, and Merchant Onboarding. Led a 1,000-seat operation and owned operational strategy, financial governance, multi-site delivery, regulatory compliance, and the operating model during major M&A integration. Responsible for CRM transitions, digital support channel oversight, workforce planning, and operational governance frameworks.',
      highlights: [
        'Accountable for Service, Retention, Chargebacks and Onboarding across a 1,000-seat operation.',
        'Reduced cost-to-serve by £3m annually by consolidating service sites post-M&A.',
        'Automated chargeback processing (Chargebacks911) improving accuracy and speed.',
        'Reduced onboarding time from 5 days to under 24 hours through automated KYC.',
        'Delivered 30% OPEX reduction via digital self-service (chatbots, co-browsing).',
      ],
    },
    {
      role: 'Head of Customer Onboarding',
      company: 'Worldpay',
      dates: 'Feb 2014 – Mar 2016',
      location: 'Gateshead',
      scale: ['UK SME onboarding', 'Thousands of merchants per month'],
      scope: 'Led the UK SME onboarding function, accountable for bringing thousands of new merchants onto the Worldpay platform each month while maintaining FCA-compliant due diligence. Partnered with product, risk, and technology teams to digitise the onboarding journey, integrating automation, document verification, and customer communications.',
      highlights: [
        'Digitised the onboarding process to automate document capture and verification.',
        'Balanced speed with full CDD and KYC, enabling clients to trade faster without regulatory compromise.',
        'Cut onboarding time from 5 days to under 24 hours, accelerating revenue and improving experience.',
        'Embedded audit trails and monitoring frameworks with Risk and Compliance to strengthen FCA readiness.',
        'Improved first-time-right submission rates by 30% through process redesign and staff upskilling.',
        'Launched a client self-service portal to surface status updates and next steps in real time.',
      ],
    },
    {
      role: 'Customer Experience Manager',
      company: 'Worldpay',
      dates: 'Aug 2010 – Aug 2012',
      location: 'Gateshead',
      scale: ['Customer Relations team', 'FCA-regulated environment'],
      scope: 'Owned the Customer Relations team responsible for resolving complaints and complex queries in line with FCA regulations. Led the contact quality framework, coached front-line leaders, and partnered with cross-functional stakeholders to improve NPS, reduce complaints, and embed customer-first initiatives across the operation.',
      highlights: [
        'Delivered FCA-compliant complaint handling processes with improved resolution speed.',
        'Designed and governed the contact quality model, linking assessment to coaching and recognition.',
        'Identified and led initiatives that lifted NPS and reduced escalations across channels.',
        'Worked with contact centre leaders to embed customer experience goals into site plans.',
      ],
    },
    {
      role: 'Pay As You Go Segment Manager',
      company: 'EE',
      dates: '1998 – Jan 2010',
      location: 'Sunderland',
      scale: ['National PAYG segment', 'Multi-site operations'],
      scope: 'Owned the customer operations and service strategy for the Pay-As-You-Go segment during rapid growth. Partnered with Marketing, Product, and Operations teams to ensure every proposition launch was operationally ready, change managed, and supported by governance, training, and performance tracking.',
      highlights: [
        'Delivered operational readiness for multiple PAYG launches, aligning training and staffing plans.',
        'Translated commercial campaigns into service processes for contact centres and retail channels.',
        'Monitored activation, churn, and NPS to identify improvements and stabilise service demand.',
        'Introduced structured post-launch reviews and governance to capture lessons learned.',
        'Strengthened collaboration between head office and contact centres to speed adoption and consistency.',
      ],
    },
  ],
  achievements: [
    'Led global operations of 1,000+ FTE across four continents.',
    'Delivered multimillion-pound savings via automation and vendor optimisation.',
    'Achieved +10 NPS uplift and 40% fewer service issues through CX transformation.',
    'Cut onboarding time from 5 days to under 24 hours using automated KYC.',
    'Balanced compliance and commercial goals in FCA-regulated environments.',
  ],
  certifications: [
    'Google AI Leadership Certification',
    'Generative AI Leadership Specialisations',
    'Prompt Engineering and Applied GenAI',
    'Responsible AI and Governance',
    'AI Productivity Tools and Integration',
  ],
  education: [
    'Masters Degree, Management (International Payments Ecosystem) — Middlesex University',
  ],
  testimonials: [
    {
      name: 'Jamie Oliver',
      company: 'Worldpay',
      role: 'Executive Colleague',
      quote:
        'I\'ve worked with Paul in two large organisations and known him for over 20 years now. More recently I worked with Paul at Worldpay where I reported into him in his role of VP Operations. Paul is without doubt an inspirational people leader, he maintains very strong engagement levels with his direct reports, their teams as well as key business stakeholders. His clear work ethic combined with solid communication / collaboration with others, customer focus, effective strategy planning and alignment with key goals sets him apart from other senior leaders. He also consistently displays strong personable values, integrity and a genuine care for others at all times.',
    },
    {
      name: 'Steph Kramer',
      company: 'MindGym',
      role: 'Colleague',
      quote:
        'I had the pleasure of working closely with Paul in his role as Group Operations Director, where he led the set up of MindGym\'s operations capability in Gateshead. This was a significant piece of transformation work that cut service issues, delivered cost savings and eliminated manual processes. The result was a positive step change in both client delivery and overall satisfaction.\n\nPaul is one of those rare operators who is both highly pragmatic and deeply human. He has a real knack for cutting through complexity, finding a sensible path forward and bringing people with him in the process. As a partner, he is steady, solutions focused and always thinking a few steps ahead.\n\nAnyone lucky enough to work with Paul can count on a trusted partner who will leave things better than he found them, while being an absolute pleasure to work with along the way.',
    },
    {
      name: 'Kevin Deadman',
      company: 'MindGym',
      role: 'Functional Leader',
      quote:
        'Paul and I worked closely together for approaching three years during a period of intense change and transformation at MindGym. From scratch Paul set up an entirely new shared service operation, consolidating a number of process streams and resulting in significant operational savings.\n\nMore recently Paul spearheaded the implementation of new business wide operating systems, replacing legacy technology platforms with off the shelf SaaS solutions, providing the business with access to more modern, best in class solutions at materially lower costs.\n\nAs a line manager Paul achieved a good balance in terms of giving me the autonomy to run my functional area but also being supportive and a good sounding board for the change projects that I had initiated, helping me to refine ideas to achieve the greatest impact. In a business with deeply ingrained ways of working I always thought of Paul as a close ally and together we were able to implement some very high impact changes within operations despite having very limited resources and budgets to work with. This requires having a disciplined approach, creative problem solving and effective consensus building and stakeholder management to get change initiatives from the drawing board to successful execution.\n\nI have huge respect for Paul as an Operations Leader, he is calm under pressure, he’s tenacious in exploring solutions and better ways of doing things and he’s thorough in his execution, making sure effort and investment translates into meaningful results.',
    },
  ],
};

const timelineTrack = document.getElementById('timelineTrack');
const detailDates = document.getElementById('detailDates');
const detailRole = document.getElementById('detailRole');
const detailCompany = document.getElementById('detailCompany');
const detailLocation = document.getElementById('detailLocation');
const detailHighlights = document.getElementById('detailHighlights');
const detailMetrics = document.getElementById('detailMetrics');
const detailScope = document.getElementById('detailScope');
const detailCta = document.getElementById('detailCta');
const achievementsGrid = document.getElementById('achievementsGrid');
const certList = document.getElementById('certList');
const educationList = document.getElementById('educationList');
const yearSpan = document.getElementById('year');
const testimonialsList = document.getElementById('testimonialsList');

let activeIndex = 0;

const createNode = (role, idx) => {
  const wrapper = document.createElement('div');
  wrapper.className = 'timeline__node';
  wrapper.role = 'listitem';

  const button = document.createElement('button');
  button.type = 'button';
  button.dataset.index = idx;
  button.innerHTML = `
    <p class="eyebrow">${role.dates}</p>
    <h4>${role.role}</h4>
    <p>${role.company}</p>
  `;

  button.addEventListener('click', () => setActive(idx));
  button.addEventListener('keydown', (event) => {
    if (event.key === 'ArrowRight') {
      setActive(Math.min(idx + 1, profile.workHistory.length - 1));
      event.preventDefault();
    }
    if (event.key === 'ArrowLeft') {
      setActive(Math.max(idx - 1, 0));
      event.preventDefault();
    }
  });

  wrapper.appendChild(button);
  return wrapper;
};

const renderTimeline = () => {
  if (!timelineTrack) return;
  profile.workHistory.forEach((role, idx) => {
    const node = createNode(role, idx);
    timelineTrack.appendChild(node);
  });
};

const setActive = (idx) => {
  activeIndex = idx;
  const role = profile.workHistory[idx];
  const nodes = document.querySelectorAll('.timeline__node');
  nodes.forEach((node, nodeIdx) => node.classList.toggle('active', nodeIdx === idx));

  detailDates.textContent = role.dates;
  detailRole.textContent = role.role;
  detailCompany.textContent = role.company;
  detailLocation.textContent = role.location;

  detailMetrics.innerHTML = '';
  role.scale.forEach((metric) => {
    const chip = document.createElement('span');
    chip.textContent = metric;
    detailMetrics.appendChild(chip);
  });

  // Render scope & responsibilities section
  if (detailScope) {
    if (role.scope) {
      detailScope.innerHTML = `
        <h4>Scope & Responsibilities</h4>
        <p>${role.scope}</p>
      `;
    } else {
      detailScope.innerHTML = '';
    }
  }

  detailHighlights.innerHTML = '';
  role.highlights.forEach((point) => {
    const li = document.createElement('li');
    li.textContent = point;
    detailHighlights.appendChild(li);
  });

  if (detailCta) {
    if (role.cta) {
      const encodedUrl = encodeURI(role.cta.url);
      detailCta.innerHTML = `
        <a class="btn ghost" href="${encodedUrl}" target="_blank" rel="noreferrer noopener">
          ${role.cta.label}
        </a>
      `;
    } else {
      detailCta.innerHTML = '';
    }
  }

  nodes[idx].scrollIntoView({ inline: 'center', behavior: 'smooth', block: 'nearest' });
};

const renderAchievements = () => {
  if (!achievementsGrid) return;
  const achievementIds = {
    'Led global operations of 1,000+ FTE across four continents.': 'impact-global-ops',
    'Delivered multimillion-pound savings via automation and vendor optimisation.': 'impact-automation',
    'Achieved +10 NPS uplift and 40% fewer service issues through CX transformation.': 'impact-cx',
    'Cut onboarding time from 5 days to under 24 hours using automated KYC.': 'impact-automation-kyc',
    'Balanced compliance and commercial goals in FCA-regulated environments.': 'impact-compliance',
  };
  profile.achievements.forEach((item) => {
    const card = document.createElement('div');
    card.className = 'panel__card';
    const id = achievementIds[item] || '';
    card.id = id;
    card.innerHTML = `<strong>Impact</strong><p>${item}</p>`;
    achievementsGrid.appendChild(card);
  });
};

const renderLists = () => {
  if (certList) {
    profile.certifications.forEach((cert) => {
      const li = document.createElement('li');
      li.textContent = cert;
      certList.appendChild(li);
    });
  }

  if (educationList) {
    profile.education.forEach((edu) => {
      const li = document.createElement('li');
      li.textContent = edu;
      educationList.appendChild(li);
    });
  }
};

const renderTestimonials = () => {
  if (!testimonialsList) return;
  testimonialsList.innerHTML = '';
  profile.testimonials.forEach((testimonial) => {
    const card = document.createElement('article');
    card.className = 'testimonial-card';
    const quoteParagraphs = testimonial.quote.split('\n\n').map(para => para.trim()).filter(para => para);
    const quoteHTML = quoteParagraphs.map(para => `<p class="testimonial-card__quote">${para}</p>`).join('');
    card.innerHTML = `
      <div class="testimonial-card__meta">
        <p class="testimonial-card__name">${testimonial.name}</p>
        <p class="testimonial-card__company">${testimonial.company}</p>
        ${testimonial.role ? `<p class="testimonial-card__role">${testimonial.role}</p>` : ''}
      </div>
      <div class="testimonial-card__content">
        ${quoteHTML}
      </div>
    `;
    testimonialsList.appendChild(card);
  });
};

if (yearSpan) {
  yearSpan.textContent = new Date().getFullYear();
}

renderTimeline();
renderAchievements();
renderTestimonials();
renderLists();
setActive(0);
